(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{10:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(26),n=a.n(c),o=a(3);a(10),a(27);var r=a(2);var i=a(5),l=a.n(i),u=a(13),j=a.n(u),d=Object(s.createContext)();function h(e){var t=Object(s.useState)(null),a=Object(o.a)(t,2),c=a[0],n=a[1],i=Object(s.useState)(""),u=Object(o.a)(i,2),h=u[0],p=u[1],b=Object(s.useState)(""),m=Object(o.a)(b,2),f=m[0],O=m[1],g=j.a.get("PHPSESSID"),v=j.a.get();return Object(s.useEffect)((function(){f||l.a.get("https://youinroll.com/lib/ajax/getToken.php",{withCredentials:!0,headers:{Cookie:"PHPSESSID=".concat(g,";")}}).then((function(e){console.log(e),e&&e.data&&O(e.data.token)})).catch((function(e){return console.log(e)})),c&&(localStorage.setItem("loggeduserid",c),l.a.get("https://youinroll.com/profile/".concat(c,"/info?api=v1.1")).then((function(e){var t=e.data.response,a="";a=t.avatar.startsWith("https")?t.avatar:t.avatar.startsWith("uploads")?"https://react.semantic-ui.com/images/wireframe/square-image.png":"https://youinroll.com/"+t.avatar,t.avatar=a,p(t)})).catch((function(e){return console.log(e)})))}),[c,g,v]),Object(r.jsx)(d.Provider,{value:{user:c,token:f,userdata:h,setUser:n},children:e.children})}var p=a(29),b=function(){return Object(r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-send",children:[Object(r.jsx)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),Object(r.jsx)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})};function m(){var e=Object(s.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],n=Object(s.useContext)(d).token,i=window.location.href.split("/")[4],u=Object(s.useState)(localStorage.getItem("stream-".concat(i))||!1),j=Object(o.a)(u,2),h=(j[0],j[1],function(){/\S/.test(a)&&l.a.post("https://youinroll.com/message/send?api=1.0",{peer_id:"s".concat(i),message:a,access_token:n}).then((function(e){console.log(e),c("")})).catch((function(e){console.log(e)}))});return Object(r.jsx)("form",{onSubmit:function(e){e.preventDefault(),h()},children:Object(r.jsxs)("div",{className:"chatFooter",children:[Object(r.jsx)(p.a,{value:a,className:"messageImput",onChange:function(e){return c(e)},cleanOnEnter:!0,onEnter:h,placeholder:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",groupNames:{smileys_people:"\u041f\u0440\u043e\u0441\u0442\u044b\u0435 \u0441\u043c\u0430\u0439\u043b\u044b",animals_nature:"\u0416\u0438\u0432\u043e\u0442\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u0430",food_drink:"\u0415\u0434\u0430 \u0438 \u043d\u0430\u043f\u0438\u0442\u043a\u0438",travel_places:"\u041f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u044f",activities:"\u0421\u043f\u043e\u0440\u0442",objects:"\u041e\u0431\u044a\u0435\u043a\u0442\u044b",symbols:"\u0421\u0438\u043c\u0432\u043e\u043b\u044b",flags:"\u0424\u043b\u0430\u0433\u0438"}}),Object(r.jsx)("div",{className:"messageSend",children:Object(r.jsx)("button",{className:"footerButton",type:"submit",children:Object(r.jsx)(b,{})})})]})})}var f=a(6),O=a.n(f),g=a(7),v=a(9),x=a(28);function S(e){var t=e.mseg,a=Object(s.useState)(null),c=Object(o.a)(a,2),n=c[0],i=c[1];return Object(s.useEffect)((function(){l.a.get("https://youinroll.com/profile/".concat(t.user_id,"/info?api=v1.1")).then((function(e){var t=e.data.response,a="";a=t.avatar.startsWith("https")?t.avatar:t.avatar.startsWith("uploads")?"https://react.semantic-ui.com/images/wireframe/square-image.png":"https://youinroll.com/"+t.avatar,t.avatar=a,i(t)})).catch((function(e){return console.log(e)}))}),[]),Object(r.jsx)("div",{className:"chatMsg",children:Object(r.jsxs)("span",{className:"authorSpan",children:[n&&Object(r.jsx)("img",{className:"chatMsgImg",src:n.avatar,alt:n.name}),Object(r.jsxs)("span",{children:[n&&Object(r.jsx)("b",{className:"userNamedec",children:"".concat(n.name.trim(),": ")}),Object(r.jsx)(x.EmojioneV4,{svg:!0,text:t.message})]})]})})}function y(e){e.toscroll;var t=Object(s.useState)([]),a=Object(o.a)(t,2),c=a[0],n=a[1],i=Object(s.useState)(0),u=Object(o.a)(i,2),j=u[0],d=u[1],h=Object(s.useState)(!1),p=Object(o.a)(h,2),b=p[0],m=p[1],f=Object(s.useRef)(null),x=window.location.href.split("/")[4];function y(){return w.apply(this,arguments)}function w(){return(w=Object(v.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("in getrecent"),l.a.get("https://youinroll.com/listen/stream?api=1.0&stream_id=".concat(x,"&ts=").concat(j)).then((function(e){if(console.log(e),e.data&&"timeout"===e.data.response)console.log("timeout");else if(e.data&&e.data.response&&Array.isArray([e.data.response])){console.log("Is array");var t=e.data.response.slice(0,parseInt(e.data.response[0].id)-j);n([].concat(Object(g.a)(c),Object(g.a)(t.reverse()))),d(parseInt(e.data.response[0].id))}m(!b)})).catch((function(e){console.log(e),m(!b)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){if(console.log("in useeffect chatmain"),0===j){var e={user_id:456,message:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0443 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u044d\u0444\u0438\u0440\u0430 \u0432 YouinRoll! \u041e\u0431\u0449\u0430\u0439\u0442\u0435\u0441\u044c \u0441 \u0432\u0435\u0434\u0443\u0449\u0438\u043c \u0438 \u0437\u0440\u0438\u0442\u0435\u043b\u044f\u043c\u0438 \u0438 \u043d\u0435 \u0437\u0430\u0431\u044b\u0432\u0430\u0439\u0442\u0435 \u0441\u043e\u0431\u043b\u044e\u0434\u0430\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u0430, \u0447\u0442\u043e\u0431\u044b \u044d\u0442\u0430 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u044f \u0431\u044b\u043b\u0430 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0439 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430."};l.a.get("https://youinroll.com/message/getAll?api=1.0&peer_id=s".concat(x)).then((function(t){if(t.data.response.length>0){if(t.data.response[0].id>j){d(parseInt(t.data.response[0].id));var a=t.data.response.slice(0,parseInt(t.data.response[0].id)-j);n([].concat(Object(g.a)(c),Object(g.a)(a.reverse()),[e]))}}else y();m(!b)})).catch((function(e){console.log(e)}))}else y()}),[b]),Object(r.jsxs)(r.Fragment,{children:[c.map((function(e){return Object(r.jsx)(S,{mseg:e},e.id)})),Object(r.jsx)("div",{ref:f})]})}function w(){return Object(r.jsxs)("div",{className:"chatHeader",children:[Object(r.jsx)("div",{children:Object(r.jsx)("h3",{children:"\u0427\u0410\u0422 \u0422\u0420\u0410\u041d\u0421\u041b\u042f\u0426\u0418\u0418"})}),Object(r.jsx)("div",{className:"chatHeaderImg",children:Object(r.jsx)("img",{src:"https://youinroll.com/storage/media/ac9ff41aee4b2ebd3ea900551bb2bce6-1.jpg",alt:"asdfjsdfa"})})]})}function N(){var e=Object(s.useState)(!0),t=Object(o.a)(e,2),a=t[0],c=(t[1],Object(s.useState)(window.scrollY)),n=Object(o.a)(c,2);n[0],n[1];return Object(r.jsx)(h,{children:Object(r.jsx)("div",{className:"App",children:Object(r.jsxs)("div",{className:"chatWrapper",children:[Object(r.jsx)(w,{}),Object(r.jsx)("div",{className:"chatmain",onScroll:function(e){console.log(e)},children:Object(r.jsx)(y,{toscroll:a})}),Object(r.jsx)(m,{})]})})})}var k=document.getElementById("chatik");n.a.render(Object(r.jsx)(s.StrictMode,{children:Object(r.jsx)(N,{})}),k)}},[[67,1,2]]]);
//# sourceMappingURL=main.9365d128.chunk.js.map